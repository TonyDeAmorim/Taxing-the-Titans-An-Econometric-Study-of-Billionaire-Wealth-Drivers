---
title: "Taxing the Titans : An Econometric Study of Billionaire Wealth Drivers"
author: "Tony De Amorim"
format: html
toc: true
---

# Accesing the sources

-   The project's repository is available [here](https://github.com/TonyDeAmorim/Taxing-the-Titans-An-Econometric-Study-of-Billionaire-Wealth-Drivers).

-   Our core dataset is available for download directly on the page of the article [The Origins of the Superrich: The Billionaire Characteristics Database](https://www.piie.com/publications/working-papers/origins-superrich-billionaire-characteristics-database).

All the World Bank's datasets used are listed here :

-   The [Total population](https://data.worldbank.org/indicator/SP.POP.TOTL) dataset
-   The [Gross capital formation (% of GDP)](https://data.worldbank.org/indicator/NE.GDI.TOTL.ZS) dataset
-   The [Foreign direct investment, net inflows (% of GDP)](https://data.worldbank.org/indicator/BX.KLT.DINV.WD.GD.ZS) dataset
-   The [Tax revenue (% of GDP)](https://data.worldbank.org/indicator/GC.TAX.TOTL.GD.ZS) dataset

To use it, simply follow the link and download it on a csv format.

We also use a dataset from the IMF accessible with the following instructions :

-   Go to the [IMF data explorer](https://data.imf.org/en/Data-Explorer)
-   Select the "World Economic Outlook (WEO)" dataset
-   Select the "Gross domestic product (GDP), Current prices, Purchasing power parity (PPP) international dollar, ICP benchmarks 2017-2021" indicator
-   Select "All" as a Time Period
-   Download "Data on this page" in a csv format

```{r}
#| label: Library imports
#| message: false
#| warning: false

library(readxl) # To open the billionaires dataset
library(tidyverse) # To clean, modify and analyze our data
library(ggplot2) # For graphical representation
library(stringr) # To clean the data
```

```{r}
#| label: Data imports
#| message: false
#| warning: false

Billionaires <- read_delim("Database_project/Billionaires_dataset.csv",
  delim = ";", escape_double = FALSE, trim_ws = TRUE
)

IMF <- read_csv("Database_project/IMF_GDP_PPP.csv")

FDI <- read_csv("Database_project/FDI_WB.csv",
  skip = 3
)

Tax_revenue <- read_csv("Database_project/Tax_revenue.csv",
  skip = 3
)

Capital_formation <- read_csv("Database_project/Capital_formation.csv",
  skip = 3
)

Population <- read_csv("Database_project/Population.csv",
  skip = 3
)
```

## Data description

::: panel-tabset
### Billionaires dataset

|  |  |
|------------------------------------|------------------------------------|
| Number of observations | `r nrow(Billionaires)` |
| Number of variables | `r ncol(Billionaires)` |
| Number of numerical variables | `r sum(sapply(Billionaires, is.numeric))` |
| Number of character variables | `r sum(sapply(Billionaires, is.character))` |
| Number of missing values | `r sum(is.na(Billionaires))` |
| Source | Peterson Institute for International Economics |
| Dataset name | The Origins of the Superrich : The Billionaire Characteristics Database |

### IMF dataset

|  |  |
|------------------------------------|------------------------------------|
| Number of observations | `r nrow(IMF)` |
| Number of variables | `r ncol(IMF)` |
| Number of numerical variables | `r sum(sapply(IMF, is.numeric))` |
| Number of character variables | `r sum(sapply(IMF, is.character))` |
| Number of factor variables | `r sum(sapply(IMF, is.factor))` |
| Number of logical variables | `r sum(sapply(IMF, is.logical))` |
| Number of date variables | `r sum(sapply(IMF, inherits, what = "Date"))` |
| Number of missing values | `r sum(is.na(IMF))` |
| Source | IMF data explorer |
| Dataset name | GDP, Current prices, PPP international dollar |
| Series code | PPPGDP.A |

### FDI dataset

|  |  |
|------------------------------------|------------------------------------|
| Number of observations | `r nrow(FDI)` |
| Number of variables | `r ncol(FDI)` |
| Number of numerical variables | `r sum(sapply(FDI, is.numeric))` |
| Number of character variables | `r sum(sapply(FDI, is.character))` |
| Number of factor variables | `r sum(sapply(FDI, is.factor))` |
| Number of logical variables | `r sum(sapply(FDI, is.logical))` |
| Number of date variables | `r sum(sapply(FDI, inherits, what = "Date"))` |
| Number of missing values | `r sum(is.na(FDI))` |
| Source | World Bank data explorer |
| Dataset name | Foreign direct investment, net inflows (% of GDP) |
| Series code | BX.KLT.DINV.WD.GD.ZS |

### Population dataset

|  |  |
|------------------------------------|------------------------------------|
| Number of observations | `r nrow(Population)` |
| Number of variables | `r ncol(Population)` |
| Number of numerical variables | `r sum(sapply(Population, is.numeric))` |
| Number of character variables | `r sum(sapply(Population, is.character))` |
| Number of factor variables | `r sum(sapply(Population, is.factor))` |
| Number of logical variables | `r sum(sapply(Population, is.logical))` |
| Number of date variables | `r sum(sapply(Population, inherits, what = "Date"))` |
| Number of missing values | `r sum(is.na(Population))` |
| Source | World Bank data explorer |
| Dataset name | Population, total |
| Series code | SP.POP.TOTL |

### Tax revenue dataset

|  |  |
|------------------------------------|------------------------------------|
| Number of observations | `r nrow(Tax_revenue)` |
| Number of variables | `r ncol(Tax_revenue)` |
| Number of numerical variables | `r sum(sapply(Tax_revenue, is.numeric))` |
| Number of character variables | `r sum(sapply(Tax_revenue, is.character))` |
| Number of factor variables | `r sum(sapply(Tax_revenue, is.factor))` |
| Number of logical variables | `r sum(sapply(Tax_revenue, is.logical))` |
| Number of date variables | `r sum(sapply(Tax_revenue, inherits, what = "Date"))` |
| Number of missing values | `r sum(is.na(Tax_revenue))` |
| Source | World Bank data explorer |
| Dataset name | Tax revenue (% of GDP) |
| Series code | GC.TAX.TOTL.GD.ZS |

### Capital formation dataset

|  |  |
|------------------------------------|------------------------------------|
| Number of observations | `r nrow(Capital_formation)` |
| Number of variables | `r ncol(Capital_formation)` |
| Number of numerical variables | `r sum(sapply(Capital_formation, is.numeric))` |
| Number of character variables | `r sum(sapply(Capital_formation, is.character))` |
| Number of factor variables | `r sum(sapply(Capital_formation, is.factor))` |
| Number of logical variables | `r sum(sapply(Capital_formation, is.logical))` |
| Number of date variables | `r sum(sapply(Capital_formation, inherits, what = "Date"))` |
| Number of missing values | `r sum(is.na(Capital_formation))` |
| Source | World Bank data explorer |
| Dataset name | Gross capital formation (% of GDP) |
| Series code | NE.GDI.TOTL.ZS |
:::

# Cleaning of the billionaires' dataset

```{r}
#| label: Standardization of country names of the billionaires' dataset
#| message: false
#| warning: false

# We here used AI to help us creating list of country names in order  
# to have the same identification tool across all our data sets
# We start by creating a list of the names of the countries  
# in our core dataset : the billionaires' one

# Creating a list of every country represented in the dataset
Country <-
  Billionaires |>
  distinct(citizenship)

# Creating by hand, with the help of AI, a text list of those countries

liste_pays <- c(
  "Algeria", "Angola", "Argentina", "Australia", "Austria", "Bahrain", 
  "Belgium", "Bermuda", "Brazil", "Canada", "Chile", "China", "Colombia", 
  "Cyprus", "Czech Republic", "Denmark", "Ecuador", "Egypt", "Finland", 
  "France", "Georgia", "Germany", "Greece", "Guernsey", "Hong Kong", "India",
  "Indonesia", "Ireland", "Israel", "Italy", "Japan", "Kazakhstan", "Kuwait",
  "Lebanon", "Liechtenstein", "Lithuania", "Macau", "Malaysia", "Mexico", 
  "Monaco", "Morocco", "Nepal", "Netherlands", "New Zealand", "Nigeria", 
  "Norway", "Oman", "Peru", "Philippines", "Poland", "Portugal", "Romania", 
  "Russia", "Saudi Arabia", "Singapore", "South Africa", "South Korea", 
  "Spain", "St. Kitts and Nevis", "Swaziland", "Sweden", "Switzerland", 
  "Taiwan", "Tanzania", "Thailand", "Turkey", "Uganda", "Ukraine", 
  "United Arab Emirates", "United Kingdom", "United States",
  "Venezuela", "Vietnam"
)
```

# Standardization of the IMF dataset

```{r}
#| label: Standardization of country names of the IMF's dataset
#| message: false
#| warning: false

# Converting the names of the countries from the IMF GDP/PPP dataset that 
# are spelled differently the same way as the countries from 
# the billionaires dataset by hand, with the help of AI

map_IMF <- c(
  "Bahrain, Kingdom of" = "Bahrain",
  "China, People's Republic of" = "China",
  "Egypt, Arab Republic of" = "Egypt",
  "Hong Kong Special Administrative Region, People's Republic of China" = "Hong Kong",
  "Kazakhstan, Republic of" = "Kazakhstan",
  "Liechtenstein, Principality of" = "Liechtenstein",
  "Lithuania, Republic of" = "Lithuania",
  "Macao Special Administrative Region, People's Republic of China" = "Macau",
  "Netherlands, The" = "Netherlands",
  "Poland, Republic of" = "Poland",
  "Russian Federation" = "Russia",
  "Korea, Republic of" = "South Korea",
  "Eswatini, Kingdom of" = "Swaziland",
  "Taiwan Province of China" = "Taiwan",
  "Tanzania, United Republic of" = "Tanzania",
  "Türkiye, Republic of" = "Turkey",
  "Venezuela, República Bolivariana de" = "Venezuela"
)

IMF <-
  IMF |>
  mutate(COUNTRY = recode(COUNTRY, !!!map_IMF))

# Selecting only the countries also present in the core dataset

IMF <-
  IMF |>
  filter(COUNTRY %in% liste_pays) 

# Creating a sub dataset for futur studies with only the years 
# also present in the core dataset

IMF_reduced <-
  IMF |>
  select(COUNTRY, `1996`, `2000`, `2014`)
```

After this standardization we realised we had to remove Monaco and Guernsey from the list of billionaires as they are not included in the IMF GDP list.

# Standardization of every World Bank datasets

```{r}
#| label: Standardization of country names of the World Bank's datasets
#| message: false
#| warning: false

# Using the FDI dataset as a blueprint of standard names of countries 
# in all World Bank's datasets

WB_names <-
  FDI |>
  distinct(`Country Name`)

# Creating a map object used later to convert the names from World Bank's 
# datasets into the format of our core dataset by hand, with the help of AI

map_WB <- c(
  "Czechia" = "Czech Republic",
  "Egypt, Arab Rep." = "Egypt",
  "Hong Kong SAR, China" = "Hong Kong",
  "Macao SAR, China" = "Macau",
  "Russian Federation" = "Russia",
  "Korea, Rep." = "South Korea",
  "Venezuela, RB" = "Venezuela",
  "Viet Nam" = "Vietnam"
)
```

## FDI dataset

```{r}
#| label: FDI dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

FDI <-
  FDI |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

FDI <-
  FDI |>
  filter(`Country Name` %in% liste_pays) |> 
  rename(COUNTRY = `Country Name`)

# Creating a sub dataset for future studies with only the years 
# also present in the core dataset

FDI_reduced <-
  FDI |>
  select(COUNTRY, `1996`, `2000`, `2014`)

```

## Tax revenue dataset

```{r}
#| label: Tax revenue dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

Tax_revenue <-
  Tax_revenue |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

Tax_revenue <-
  Tax_revenue |>
  filter(`Country Name` %in% liste_pays)|> 
  rename(COUNTRY = `Country Name`)

# Creating a sub dataset for future studies with only the years 
# also present in the core dataset

Tax_revenue_reduced <-
  Tax_revenue |>
  select(COUNTRY, `1996`, `2000`, `2014`)

```

## Capital formation dataset

```{r}
#| label: Capital formation dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

Capital_formation <-
  Capital_formation |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

Capital_formation <-
  Capital_formation |>
  filter(`Country Name` %in% liste_pays)|> 
  rename(COUNTRY = `Country Name`)

# Creating a sub dataset for future studies with only the years 
# also present in the core dataset

Capital_formation_reduced <-
  Capital_formation |>
  select(COUNTRY, `1996`, `2000`, `2014`)

```

## Population dataset

```{r}
#| label: Population dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

Population <-
  Population |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

Population <-
  Population |>
  filter(`Country Name` %in% liste_pays)|> 
  rename(COUNTRY = `Country Name`)

# Creating a sub dataset for future studies with only the years 
# also present in the core dataset

Population_reduced <-
  Population |>
  select(COUNTRY, `1996`, `2000`, `2014`)

```
