---
title: "Taxing the Titans : An Econometric Study of Billionaire Wealth Drivers"
author: "Tony De Amorim"
format: html
---

 

```{r}
#| label: Library imports
#| message: false
#| warning: false

library(readxl) # To open the billionaires dataset
library(tidyverse) # To clean, modify and analyze our data 
library(ggplot2) # For graphical representation
library(stringr) # To clean the data

```


```{r}
#| label: Data import
#| message: false
#| warning: false

#Importing the dataset using the readxl package

Billionaires <- read_excel("Database_project/Billionaires1996,2001and2014updated.xlsx") 

# Importing an IMF custom dataset

IMF <- read_csv("Database_project/dataset_2025-11-08T13_13_40.824575072Z_DEFAULT_INTEGRATION_IMF.RES_WEO_9.0.0.csv")

```


```{r}
#| label: Data cleaning
#| message: false
#| warning: false


Billionaires <-
  Billionaires |> 
  select(!(25:30)) |>  # Removing un-needed variables : notes and sources
  mutate(name = str_remove_all(name, "[.,;()]")) 
  # Removing typo in the names that might prevent good identification of every billionaires
  
# Pivoting in order to have one row by billionaire   
Pivoted <-
  Billionaires |> 
  pivot_wider(names_from = year,
              values_from = c(rank,networthusbillion, gdpcurrentus),
              id_cols = name)

# Joining the pivoted and the original datasets
Billionaires <-
  Billionaires |>
  select(!c(year,rank,networthusbillion,gdpcurrentus)) |>
  distinct(name, .keep_all = TRUE) |> 
  full_join(Pivoted, by = "name")

# Creating a list of every country represented in the dataset
Country <- 
  Billionaires |> 
  distinct(citizenship) 

# Cleaning the IMF dataset

IMF <-
  IMF |>  
  select(COUNTRY,INDICATOR,SCALE,UNIT,TOPIC,SERIES_NAME, 76:100)

# Creating a dataset with only our years

IMF_reduced <-
  IMF |> 
  select(1,2,13,18,31) |> 
  pivot_wider(names_from = INDICATOR, 
              values_from = c("1996","2001","2014"),
              id_cols = COUNTRY)

c <-
  IMF |> 
  distinct(COUNTRY)


```

