---
title: "Taxing the Titans : An Econometric Study of Billionaire Wealth Drivers"
author: "Tony De Amorim"
format: html
---

# Accesing the sources

The project's repository is available [here](https://github.com/TonyDeAmorim/Taxing-the-Titans-An-Econometric-Study-of-Billionaire-Wealth-Drivers). 

Our core dataset is available for download directly through [this link](https://www.piie.com/publications/working-papers/origins-superrich-billionaire-characteristics-database). 


```{r}
#| label: Library imports
#| message: false
#| warning: false

library(readxl) # To open the billionaires dataset
library(tidyverse) # To clean, modify and analyze our data
library(ggplot2) # For graphical representation
library(stringr) # To clean the data
```

```{r}
#| label: Data imports
#| message: false
#| warning: false

Billionaires <- read_delim("Database_project/Billionaires_dataset.csv",
  delim = ";", escape_double = FALSE, trim_ws = TRUE
)

IMF <- read_csv("Database_project/IMF_GDP_PPP.csv")

FDI <- read_csv("Database_project/FDI_WB.csv", skip = 3)

Tax_revenue <- read_csv("Database_project/Tax_revenue_dataset.csv")

Capital_formation <- read_csv("Database_project/Capital_formation.csv")

Population <- read_csv("Database_project/Population.csv",
  skip = 3
)
```

# Description of the billionaires' dataset

```{r}
#| label: Standardization of country names : billionaires' dataset
#| message: false
#| warning: false

# We here used AI to help us creating list of country names in order to have the same identification tool across all our data sets
# We start by creating a list of the names of the countries in our core dataset : the billionaires' one

# Creating a list of every country represented in the dataset
Country <-
  Billionaires |>
  distinct(citizenship)

# Creating by hand, with the help of AI, a text list of those countries

liste_pays <- c(
  "Algeria", "Angola", "Argentina", "Australia", "Austria", "Bahrain", "Belgium",
  "Bermuda", "Brazil", "Canada", "Chile", "China", "Colombia", "Cyprus",
  "Czech Republic", "Denmark", "Ecuador", "Egypt", "Finland", "France", "Georgia",
  "Germany", "Greece", "Guernsey", "Hong Kong", "India", "Indonesia", "Ireland",
  "Israel", "Italy", "Japan", "Kazakhstan", "Kuwait", "Lebanon", "Liechtenstein",
  "Lithuania", "Macau", "Malaysia", "Mexico", "Monaco", "Morocco", "Nepal",
  "Netherlands", "New Zealand", "Nigeria", "Norway", "Oman", "Peru", "Philippines",
  "Poland", "Portugal", "Romania", "Russia", "Saudi Arabia", "Singapore",
  "South Africa", "South Korea", "Spain", "St. Kitts and Nevis",
  "Swaziland", "Sweden", "Switzerland", "Taiwan", "Tanzania", "Thailand", "Turkey",
  "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States",
  "Venezuela", "Vietnam"
)
```

# Standardization of the IMF dataset

```{r}
#| label: Standardization of country names : FMI's dataset
#| message: false
#| warning: false

# Converting the names of the countries from the IMF GDP/PPP dataset that are spelled differently the same way as the countries from the billionaires dataset by hand, with the help of AI

map_IMF <- c(
  "Bahrain, Kingdom of" = "Bahrain",
  "China, People's Republic of" = "China",
  "Egypt, Arab Republic of" = "Egypt",
  "Hong Kong Special Administrative Region, People's Republic of China" = "Hong Kong",
  "Kazakhstan, Republic of" = "Kazakhstan",
  "Liechtenstein, Principality of" = "Liechtenstein",
  "Lithuania, Republic of" = "Lithuania",
  "Macao Special Administrative Region, People's Republic of China" = "Macau",
  "Netherlands, The" = "Netherlands",
  "Poland, Republic of" = "Poland",
  "Russian Federation" = "Russia",
  "Korea, Republic of" = "South Korea",
  "Eswatini, Kingdom of" = "Swaziland",
  "Taiwan Province of China" = "Taiwan",
  "Tanzania, United Republic of" = "Tanzania",
  "Türkiye, Republic of" = "Turkey",
  "Venezuela, República Bolivariana de" = "Venezuela"
)

IMF <-
  IMF |>
  mutate(COUNTRY = recode(COUNTRY, !!!map_IMF))

# Selecting only the countries also present in the core dataset

IMF <-
  IMF |>
  filter(COUNTRY %in% liste_pays)

# Creating a sub dataset for futur studies with only the years also present in the core dataset

IMF_reduced <-
  IMF |>
  select(COUNTRY, `1996`, `2000`, `2014`)
```

After this standardization we realised we had to remove Monaco and Guernsey from the list of billionaires as they are not included in the IMF GDP list.

# Standardization of every World Bank datasets

```{r}
#| label: Standardization of country names : World Bank's datasets
#| message: false
#| warning: false

# Using the FDI dataset as a blueprint of standard names of countries in all World Bank's datasets

WB_names <-
  FDI |>
  distinct(`Country Name`)

# Creating a map object used later to convert the names from World Bank's datasets into the format of our core dataset by hand, with the help of AI

map_WB <- c(
  "Czechia" = "Czech Republic",
  "Egypt, Arab Rep." = "Egypt",
  "Hong Kong SAR, China" = "Hong Kong",
  "Macao SAR, China" = "Macau",
  "Russian Federation" = "Russia",
  "Korea, Rep." = "South Korea",
  "Venezuela, RB" = "Venezuela",
  "Viet Nam" = "Vietnam"
)
```

## FDI dataset

```{r}
#| label: FDI dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

FDI <-
  FDI |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

FDI <-
  FDI |>
  filter(`Country Name` %in% liste_pays)

# Creating a sub dataset for futur studies with only the years also present in the core dataset

FDI_reduced <-
  FDI |>
  select(`Country Name`, `1996`, `2000`, `2014`)
```


## Tax revenue dataset

```{r}
#| label: Tax revenue dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

Tax_revenue <-
  Tax_revenue |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

Tax_revenue <-
  Tax_revenue |>
  filter(`Country Name` %in% liste_pays)

# Creating a sub dataset for futur studies with only the years also present in the core dataset

Tax_revenue_reduced <-
  Tax_revenue |>
  select(`Country Name`, `1996 [YR1996]`, `2000 [YR2000]`, `2014 [YR2014]`)
```

## Capital formation dataset

```{r}
#| label: Capital formation dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

Capital_formation <-
  Capital_formation |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

Capital_formation <-
  Capital_formation |>
  filter(`Country Name` %in% liste_pays)

# Creating a sub dataset for futur studies with only the years also present in the core dataset

Capital_formation_reduced <-
  Capital_formation |>
  select(`Country Name`, `1996 [YR1996]`, `2000 [YR2000]`, `2014 [YR2014]`)
```

## Population dataset

```{r}
#| label: Population dataset
#| message: false
#| warning: false

# Using the map object creatd previously to standardize country names

Population <-
  Population |>
  mutate(`Country Name` = recode(`Country Name`, !!!map_WB))

# Selecting only the countries also present in the core dataset

Population <-
  Population |>
  filter(`Country Name` %in% liste_pays)

# Creating a sub dataset for futur studies with only the years also present in the core dataset

Population_reduced <-
  Population |>
  select(`Country Name`, `1996`, `2000`, `2014`)
```
